# دليل نشر متجر نون (Noon Clone Deployment Guide)

يوضح هذا الدليل كيفية نشر المتجر الإلكتروني، السيرفر، وقاعدة البيانات باستخدام منصات حديثة مثل **Vercel** أو **Render**.

---

## 1. استضافة قاعدة البيانات (Database Hosting)
بما أننا استخدمنا **Prisma** مع **PostgreSQL**، يمكنك استخدام:
- **Neon.tech**: (مستخدم حالياً في المشروع) يوفر أداءً عالياً وتوسيعاً تلقائياً.
- **Render PostgreSQL**: خيار ممتاز إذا كنت تريد بقاء قاعدة البيانات والسيرفر في نفس المنصة.

---

## 2. النشر عبر منصة Render (Render.com)
تعتبر **Render** منصة متكاملة لاستضافة "تطبيقات الويب" (Web Services) وقواعد البيانات.

### خطوات نشر المتجر (Next.js) على Render:
1. **ربط الحساب**: أنشئ حساباً على [Render.com](https://render.com) واربطه بحسابك على **GitHub**.
2. **إنشاء خدمة جديدة**: اضغط على **New +** ثم اختر **Web Service**.
3. **اختيار المستودع**: اختر مستودع المتجر الخاص بك.
4. **إعدادات البناء (Build Settings)**:
   - **Runtime**: `Node`
   - **Build Command**: `npm install && npx prisma generate && npm run build`
   - **Start Command**: `npm run start`
5. **متغيرات البيئة (Environment Variables)**:
   انقر على قسم **Env Vars** وأضف:
   - `DATABASE_URL`: (قم بلصق الرابط الخاص بـ Neon أو Render DB).
   - `NODE_VERSION`: `20` (أو الإصدار المستخدم).
6. **النشر**: اضغط على **Create Web Service**. سيقوم Render ببناء التطبيق وتوفير رابط بصيغة `your-app.onrender.com`.

---

## 3. النشر عبر منصة Vercel (الموصى به)
Vercel هي الأفضل لتطبيقات **Next.js** من حيث السرعة وسهولة التعامل مع الصور (Image Optimization).

1. ارفع الكود على **GitHub**.
2. في Vercel، اختر **Import Project**.
3. سيقوم Vercel باكتشاف Next.js تلقائياً.
4. أضف `DATABASE_URL` في قسم **Environment Variables**.
5. سيتم النشر تلقائياً فور كل عملية `git push`.

---

## 4. تحديثات قاعدة البيانات (Prisma)
سواء اخترت Render أو Vercel، يجب التأكد من تحديث هيكل الجداول:
- في Render، يتم ذلك عبر إضافة `npx prisma db push` في أمر البناء (**Build Command**).
- في Vercel، يفضل تشغيلها محلياً مرة واحدة أو عبر **GitHub Actions**.

---

## 5. إعدادات النطاق الخاص (Custom Domain)
1. في Render أو Vercel، انتقل إلى إعدادات **Domains**.
2. أضف نطاقك (مثلاً `myshop.com`).
3. قم بتحديث سجلات **CNAME** في لوحة تحكم نطاقك لتشير إلى رابط الاستضافة المزود.

---

## 6. نصائح هامة لبيئة الإنتاج:
- **الباقة المجانية في Render**: تدخل الخدمة في حالة "نوم" (Sleep) إذا لم تكن هناك زيارات، مما قد يسبب تأخراً في التحميل لأول زائر. (يفضل الباقة المدفوعة للمتاجر الحقيقية).
- **الأمان**: تأكد دائماً أن ملف `.env` مضاف لملف `.gitignore` لعدم تسريب بيانات قاعدة البيانات.
